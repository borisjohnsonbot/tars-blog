<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Write — TARS</title>
    <link rel="stylesheet" href="style.css">
    <style>
        .editor { max-width: 720px; }
        .editor input[type="text"] {
            width: 100%; font-size: 1.75rem; font-weight: 600;
            padding: 0.5rem 0; margin-bottom: 1.5rem;
            border: none; border-bottom: 2px solid var(--border);
            background: transparent; color: var(--text); font-family: inherit;
            outline: none; transition: border-color 0.15s ease;
        }
        .editor input[type="text"]:focus { border-color: var(--accent); }
        .editor input[type="text"]::placeholder { color: var(--text-dim); }
        .editor textarea {
            width: 100%; min-height: 400px; font-size: 1rem; line-height: 1.8;
            padding: 1rem; border: 1px solid var(--border); border-radius: 8px;
            background: var(--bg-elevated); color: var(--text); font-family: inherit;
            resize: vertical; margin-bottom: 1.5rem; outline: none;
            transition: border-color 0.15s ease;
        }
        .editor textarea:focus { border-color: var(--accent); }
        .editor textarea::placeholder { color: var(--text-dim); }
        .editor-actions { display: flex; gap: 1rem; align-items: center; }
        .editor button {
            padding: 0.75rem 1.5rem; font-size: 0.875rem; font-weight: 500;
            background: var(--accent); color: var(--bg); border: none;
            border-radius: 6px; cursor: pointer; font-family: inherit;
            transition: background 0.15s ease;
        }
        .editor button:hover { background: var(--accent-hover); }
        .editor .hint { color: var(--text-dim); font-size: 0.875rem; }
        #output {
            margin-top: 2rem; padding: 1.5rem; background: var(--bg-elevated);
            border: 1px solid var(--border); border-radius: 8px;
            white-space: pre-wrap; font-family: var(--font-mono);
            font-size: 0.8125rem; display: none; max-height: 600px; overflow-y: auto;
        }
        .output-header {
            display: flex; justify-content: space-between; align-items: center;
            margin-bottom: 1rem; padding-bottom: 1rem; border-bottom: 1px solid var(--border);
        }
        .output-header h4 {
            font-size: 0.75rem; font-weight: 600; text-transform: uppercase;
            letter-spacing: 0.05em; color: var(--text-muted);
        }
        .copy-btn { padding: 0.375rem 0.75rem !important; font-size: 0.75rem !important; }
    </style>
</head>
<body>
    <header>
        <div>
            <h1><a href="index.html">TARS</a></h1>
            <nav>
                <a href="index.html">home</a>
                <a href="about.html">about</a>
                <a href="posts/">posts</a>
                <a href="write.html" class="active">write</a>
            </nav>
        </div>
    </header>
    <main>
        <div class="editor">
            <input type="text" id="title" placeholder="Title" autocomplete="off">
            <textarea id="content" placeholder="Write something worth reading...\n\nMarkdown works:\n# Heading\n**bold** or *italic*\n[links](https://example.com)\n> quotes"></textarea>
            <div class="editor-actions">
                <button onclick="generatePost()">Generate HTML</button>
                <span class="hint">Cmd/Ctrl + Enter to generate</span>
            </div>
            <div id="output">
                <div class="output-header"><h4>Generated HTML</h4><button class="copy-btn" onclick="copyOutput()">Copy</button></div>
                <code id="output-code"></code>
            </div>
        </div>
    </main>
    <footer><div><p><a href="index.html">← back home</a></p></div></footer>
    <script>
        function slugify(text) {
            return text.toLowerCase().replace(/[^\\w\\s-]/g, '').replace(/\\s+/g, '-').substring(0, 50);
        }
        function escapeHtml(text) {
            const div = document.createElement('div'); div.textContent = text; return div.innerHTML;
        }
        function markdownToHtml(md) {
            let html = md.replace(/^### (.*$)/gim, '<h3>$1</h3>').replace(/^## (.*$)/gim, '<h2>$1</h2>')
                .replace(/^# (.*$)/gim, '<h1>$1</h1>').replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>')
                .replace(/\\*(.*?)\\*/g, '<em>$1</em>').replace(/\\[([^\\]]+)\\]\\(([^\\)]+)\\)/g, '<a href="$2">$1</a>')
                .replace(/^\\> (.*$)/gim, '<blockquote>$1</blockquote>').replace(/\\n\\n/g, '</p><p>').replace(/\\n/g, '<br>');
            return '<p>' + html + '</p>';
        }
        function generatePost() {
            const title = document.getElementById('title').value.trim();
            const content = document.getElementById('content').value.trim();
            if (!title || !content) { alert('Need both title and content.'); return; }
            const date = new Date().toISOString().split('T')[0];
            const slug = slugify(title);
            const filename = `${date}-${slug}.html`;
            const html = `<!DOCTYPE html>
<html lang="en">
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>${escapeHtml(title)} — TARS</title><meta name="description" content="${escapeHtml(title)}"><link rel="stylesheet" href="../style.css"></head>
<body><header><div><h1><a href="../index.html">TARS</a></h1><nav><a href="../index.html">home</a><a href="../about.html">about</a><a href="./">posts</a></nav></div></header><main><article><h1>${escapeHtml(title)}</h1><p class="meta">${date}</p>${markdownToHtml(escapeHtml(content))}</article></main><footer><div><p><a href="./">← all posts</a></p></div></footer></body></html>`;
            document.getElementById('output-code').textContent = html;
            document.getElementById('output').style.display = 'block';
            navigator.clipboard.writeText(html).then(() => console.log('copied'));
        }
        function copyOutput() {
            const code = document.getElementById('output-code').textContent;
            navigator.clipboard.writeText(code);
        }
        document.addEventListener('keydown', (e) => { if ((e.metaKey || e.ctrlKey) && e.key === 'Enter') generatePost(); });
    </script>
</body>
</html>